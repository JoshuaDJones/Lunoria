@inject Blazored.LocalStorage.ILocalStorageService LocalStorageService
@inject NavigationManager NavigationManager

@if(allowed)
{
    @ChildContent
}

@code {
    [Parameter] public RenderFragment ChildContent { get; set; } = default!;

    private bool allowed = false;

    protected override async Task OnInitializedAsync()
    {
        var token = await LocalStorageService.GetItemAsync<string>("authToken");

        if (string.IsNullOrWhiteSpace(token))
        {
            NavigationManager.NavigateTo("/Login");
            return;
        }

        allowed = true;
    }
}
